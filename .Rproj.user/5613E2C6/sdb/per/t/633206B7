{
    "contents" : "### Data preparation\nrequire(readr)\nrequire(dplyr)\nrequire(tidyr)\nrequire(ggplot2)\noriginal_data = read_delim(\"~/Downloads/Brauer2008_DataSet1.tds\", \n                           delim=\"\\t\")\ncleaned_data = original_data %>%\n  separate(NAME, \n           c(\"name\", \"BP\", \"MF\", \"systematic_name\", \"number\"), \n           sep = \"\\\\|\\\\|\") %>%\n  mutate_each(funs(trimws), name:systematic_name) %>%\n  select(-number, -GID, -YORF, -GWEIGHT)  %>%\n  gather(sample, expression, G0.05:U0.3) %>%\n  separate(sample, c(\"nutrient\", \"rate\"), sep = 1, convert = TRUE)\n\n### App code\n\nshinyApp(\n  ui=fluidPage(\n    titlePanel(\"Case Study\"),\n    fluidRow(\n      column(4,\n             wellPanel(\n               conditionalPanel(\n                 condition = \"input.tabs == 'genetab'\",\n                 selectizeInput(inputId = \"gene\",\n                                label = \"Select gene(s)\",\n                                choices = sort(unique(cleaned_data$name)),\n                                selected = \"LEU1\",\n                                multiple = TRUE)\n               ),\n               conditionalPanel(\n                 condition = \"input.tabs == 'processtab'\",\n                 selectizeInput(inputId = \"process\",\n                                label = \"Biological process\",\n                                choices = sort(unique(cleaned_data$BP)),\n                                selected = \"leucine biosynthesis\")                                \n               ),\n               checkboxInput(inputId = \"line\",\n                             label = \"Add line of best fit?\",\n                             value = FALSE)\n             )\n             #              ,wellPanel(\n             #                sliderInput(inputId = \"height\",\n             #                            label = \"Plot height\",\n             #                            value = 400,\n             #                            min=400, max=1000)\n             #              )\n      ),\n      column(8,\n             tabsetPanel(id = \"tabs\",\n                         tabPanel(\"Gene\", value = \"genetab\"\n                                  ,plotOutput(\"plot1\")\n                                  #,uiOutput(\"plot3\")\n                         ),\n                         tabPanel(\"Process\", value = \"processtab\",\n                                  plotOutput(\"plot2\")\n                         )\n             )\n      )\n    )\n  ),\n  shinyServer(function(input, output) {\n    \n    output$plot1 = renderPlot({\n      if(input$line){\n        cleaned_data %>%\n          filter(is.element(name, input$gene)) %>%\n          ggplot(aes(rate, expression, color = nutrient)) +\n          geom_point() + theme_bw(base_size = 14) + \n          geom_smooth(method = \"lm\", se = FALSE)  + \n          facet_wrap(~name)\n      } else {\n        cleaned_data %>%\n          filter(is.element(name, input$gene)) %>%\n          ggplot(aes(rate, expression, color = nutrient)) +\n          geom_line() + theme_bw(base_size = 14) + \n          facet_wrap(~name + systematic_name)\n      }\n    })\n    \n    output$plot2 = renderPlot({\n      if(input$line){\n        cleaned_data %>%\n          filter(BP == input$process) %>%\n          ggplot(aes(rate, expression, color = nutrient)) +\n          geom_point() + theme_bw(base_size = 14) + \n          facet_wrap(~name + systematic_name) +\n          geom_smooth(method = \"lm\", se = FALSE)   \n      } else {\n        cleaned_data %>%\n          filter(BP == input$process) %>%\n          ggplot(aes(rate, expression, color = nutrient)) +\n          geom_line() + theme_bw(base_size = 14) + \n          facet_wrap(~name + systematic_name)\n      }\n    })\n    # if you want reactive plot heights \n    #     output$plot3 = renderUI({\n    #       plotOutput(\"plot1\", height = input$height)\n    #     })\n  })\n)\n",
    "created" : 1448076207213.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1296042217",
    "id" : "633206B7",
    "lastKnownWriteTime" : 1448082984,
    "path" : "~/Dropbox/Consulting/Wshops/visR/labs/01/app.R",
    "project_path" : "labs/01/app.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "type" : "r_source"
}